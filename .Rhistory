library(RColorBrewer)
library(reshape2)
library(heatmap3)
install.packages("heatmap3")
install.packages("heatmap3")
###ALL###
#data
#virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/1. LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop20.csv", header=T,	row.names=1,sep=",")
virusmatrix = read.table("/Users/michealmacaogain/Dropbox/Research/Publications/63. SNF in bronchiectasis/1. LRM/Figures/Figure 3/bacteriaFungiVirusRA3reorderRenamTop10other.csv"
, header=T,	row.names=1,sep=",") #10 taxa
virusmatrix = as.matrix(t(virusmatrix)) #transpose to matrix
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# melt the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
library(reshape2)
library(heatmap3)
library(RColorBrewer)
#colourmatrix
x = data.frame(
id   = c(1, 1, 2, 2),
white = c(1, 0, 1, 0),
cyan  = c(0, 1, 0, 1),
red  = c(0, 1, 0, 1)
)
# melt the data frame
melt(data = x, id.vars = "id", measure.vars = c("white", "cyan", "red"))
#select a colour scheme
#alternative
Colors=c("#eeeeee", "#ffff00", "#663399")
#bacteria
#Colors=c("white", "light blue", "#3590ae")
#Colors=c("white", "light blue", "#3590ae")
Colors=c("white", "#C9D6F8", "#0D2CB4") #chosen
#set a colour palette
Colors=colorRampPalette(Colors)(255)
#set Label for RowSideColors (side bar colour scheme for kingdoms)
Label =
c('#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312','#B81312',
'#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52','#2FAC52',
'#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4','#0D2CB4')
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = TRUE,
margins=c(1,1))
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=TRUE, labCol = TRUE,
margins=c(1,1))
heatmap3(virusmatrix, showColDendro = F, showRowDendro = F,
Rowv = NA, col=Colors, scale = "col", cexCol=0.1,cexRow=0.5,
RowSideColors=Label, RowSideLabs=FALSE, labCol = FALSE,
margins=c(1,1))
